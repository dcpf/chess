<!DOCTYPE html>
<!-- Copyright (c) 1998 - 2013 dpf, dpf@theworld.com -->
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="description" content="Dave's Chess-By-Email - Internet Correspondence Chess">
    <meta name="keywords" content="chess-by-email, chess by email, play chess, correspondence chess">
    <meta name="author" content="David Piersol-Freedman 1998">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <title>Dave's Chess-By-Email</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="/webapp/chess.css?ver=<%= runtimestamp %>">
</head>
<body>

    <!-- Create/enter view -->
    <div id="enterGameView" style="display: none">
      <h3>Welcome to Dave's Chess-By-Email</h3>
      <hr/>
      <div id="enterGameTable">
        <input type="radio" name="newOrExisting" id="newGameRadio" value="N" tabindex="-1" checked><label for="newGameRadio" style="font-weight: bold">New Game</label>
        <div id="newGameForm">
          <fieldset>
            <label class="control-label" for="player1Email">Your Email Address</label>
            <input type="email" class="form-control" id="player1Email" maxlength="50" required>
            <label class="control-label" for="player2Email">Opponent's Email Address</label>
            <input type="email" class="form-control" id="player2Email" maxlength="50" required>
            <div id="captcha"><div id="loadingCaptchaText">Loading Captcha ...</div></div>
          </fieldset>
        </div>
        <div><hr></div>
        <input type="radio" name="newOrExisting" id="existingGameRadio" value="E" tabindex="-1"><label for="existingGameRadio" style="font-weight: bold">Continue Existing Game</label>
        <div id="existingGameForm">
          <fieldset>
            <label class="control-label" for="gameID">Game ID</label>
            <input type="text" class="form-control" id="gameID" required>
            <div><a href="#" id="forgotGameIdLink" tabindex="-1">Forgot your game ID?</a></div>
          </fieldset>
        </div>
        <div><hr></div>
        <div style="text-align: center">
          <button type="button" class="btn btn-primary" id="enterGameSubmitButton" style="margin-right: 10px" tabindex="-1">Submit</button>
          <button type="reset" class="btn" tabindex="-1">Clear</button>
        </div>
      </div>
    </div>

    <!-- Play game view-->
    <div id="playGameView">

        <!-- options menu -->
        <div id="optionsMenuContainer">

            <div id="optionsMenuIcon" title="Options">
                <div></div>
                <div></div>
                <div></div>
            </div>

            <div id="optionsMenu">
                <ul>
                    <li id="showLegalMovesOption"><a href="#">Show legal moves:</a> <span id="showLegalMovesValue"></span></li>
                    <li id="feedbackOption"><a href="#">Feedback</a></li>
                    <li><a href="/">Start new game</a></li>
                </ul>
            </div>

        </div>

        <div style="display: inline-block; vertical-align: top">

            <!-- player info -->
            <div class="playerInfo">
                <div><b>White:</b> <span id="whiteEmail"></span></div>
                <div><b>Black:</b> <span id="blackEmail"></span></div>
            </div>

            <!-- move history container -->
            <div id="moveHistoryContainer">
                <div id="replayGameLink"><a href="#">Auto-Replay</a></div>
                <table id="moveHistoryTable">
                    <tr>
                        <th style="border-bottom: none; width: 20px;"></th>
                        <th style="border-right: solid 1px #000" class="currentPlayer">White</th>
                        <th>Black</th>
                    </tr>
                </table>
            </div>

        </div>

        <div style="display: inline-block; vertical-align: top">
            <div id="messageContainer"></div>
            <!-- chess board -->
            <div id="chessBoardContainer"></div>
            <fieldset id="capturedPiecesContainer">
                <legend>Captured Pieces</legend>
                <div id="capturedBlackPieces"></div>
                <div id="capturedWhitePieces"></div>
            </fieldset>
        </div>

    </div>

</body>

<!-- dialogs -->

<div id="forgotGameIdDialog" class="modal" role="dialog" aria-hidden="true" data-backdrop="static">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3 style="border-bottom: 1px solid #000; padding-bottom: 10px;">Forgot your game ID?</h3>
  </div>
    <div class="modal-body" style="padding: 10px 20px 15px 20px">
      <div id="forgotGameIdForm">
        <p>Please enter your email address and click Submit</p>
        <p><input type="email" class="form-control" id="forgotGameIdEmail" maxlength="50" required></p>
        <p id="forgotGameIdError" style="display: none; color: red"></p>
        <p>
          <button type="button" class="btn btn-primary" id="forgotGameIdSubmitButton" style="margin-right: 10px">Submit</button>
          <button type="button" class="btn" data-dismiss="modal">Close</button>
        </p>
      </div>
      <div id="forgotGameIdSuccess" style="display: none">
        <p>An email with your game IDs has been sent to <span class="forgotGameIdEmail"></span></p>
        <button type="button" class="btn" data-dismiss="modal">Close</button>
      </div>
    </div>
</div>

<div id="progressDialog" class="modal" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-body">
        <div id="spinner">&#9816;</div>
    </div>
</div>

<div id="confirmMoveDialog" class="modal" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-body">
        <p>Please confirm your move</p>
        <div id="possibleMoves"></div>
    </div>
</div>

<div id="chessBoardSnapshotDialog" class="modal" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-body">
        <div style="text-align: right"><a href="#" class="closeIcon">Close</a></div>
        <div class="move"></div>
        <div id="chessBoardSnapshotContainer"></div>
    </div>
    <div id="tempPiecePlaceHolder"></div>
</div>

<div id="genericDialog" class="modal" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <p style="margin-bottom: 20px">&nbsp;</p>
  </div>
    <div class="modal-body" style="padding: 0 20px 15px 20px">
        <p class="genericDialogText"></p>
    </div>
</div>

<div id="feedbackDialog" class="modal" role="dialog" aria-hidden="true" data-backdrop="static">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3 style="border-bottom: 1px solid #000; padding-bottom: 10px;">Feedback</h3>
  </div>
    <div class="modal-body" style="padding: 10px 20px 15px 20px">
      <div id="feedbackForm">
        <p>Please enter your feedback (comments, bug report, etc) and email address, and click Submit.</p>
        <fieldset>
          <div>
            <label class="control-label" for="feedbackText" style="vertical-align: top">Feedback</label>
            <textarea class="form-control" id="feedbackText" style="height: 100px"></textarea>
          </div>
          <div>
            <label class="control-label" for="feedbackText">Email</label>
            <input type="email" class="form-control" id="feedbackEmail" maxlength="50">
          </div>
        </fieldset>
        <div style="margin: 10px">
          <button type="button" class="btn btn-primary" id="feedbackSubmitButton" style="margin-right: 10px">Submit</button>
          <button type="button" class="btn" data-dismiss="modal">Close</button>
        </div>
      </div>
      <div id="feedbackSuccess" style="display: none">
        <p>Thanks for your feedback!</p>
        <button type="button" class="btn" data-dismiss="modal">Close</button>
      </div>
    </div>
</div>

<script>

window.onerror = function (msg, url, lineNum) {
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/logClientError', true);
    var params = 'msg=' + encodeURIComponent(msg) + '&url=' + encodeURIComponent(url) + '&lineNum=' + lineNum;
    xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhr.send(params);
};

function log (msg) {
    if (window.console) {
        console.log(msg);
    }
}

var chessAttrs = {
    config: <%= config %>
};

</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="/webapp/chess.js?ver=<%= runtimestamp %>"></script>

</html>
